openapi: 3.0.3
info:
  title: Old World API
  description: |
    REST API for the Old World game mod that exposes game state for companion apps, overlays, and external tools.

    ## Overview

    This API provides read-only access to game state including players, cities, characters, tribes, diplomacy, and events.
    All data uses game type strings (e.g., `NATION_ROME`, `YIELD_FOOD`) for unambiguous identification.

    ## Connection

    The HTTP REST server runs on port 9877 when the mod is active and a game is loaded.

    ## CORS

    All endpoints include CORS headers for browser access:
    - `Access-Control-Allow-Origin: *`
    - `Access-Control-Allow-Methods: GET`
  version: 1.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:9877
    description: Local HTTP REST server

tags:
  - name: State
    description: Full game state
  - name: Players
    description: Player (nation) data
  - name: Cities
    description: City data
  - name: Characters
    description: Character data
  - name: Units
    description: Unit data
  - name: Tiles
    description: Map tile data
  - name: Events
    description: Turn-based event detection
  - name: Tribes
    description: Tribe (barbarian) data
  - name: Diplomacy
    description: Diplomatic relationships
  - name: Religion
    description: Global religion state
  - name: Config
    description: Game configuration

paths:
  /state:
    get:
      tags: [State]
      summary: Get full game state
      description: Returns comprehensive game state including all players, cities, characters, tribes, and diplomacy.
      operationId: getState
      responses:
        '200':
          description: Full game state
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GameState'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /players:
    get:
      tags: [Players]
      summary: Get all players
      description: Returns array of all players with stockpiles and rates.
      operationId: getPlayers
      responses:
        '200':
          description: Array of players
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Player'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /player/{index}:
    get:
      tags: [Players]
      summary: Get player by index
      description: Returns a single player by their 0-based index.
      operationId: getPlayerByIndex
      parameters:
        - name: index
          in: path
          required: true
          schema:
            type: integer
            minimum: 0
          description: Player index (0-based)
      responses:
        '200':
          description: Player data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Player'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /cities:
    get:
      tags: [Cities]
      summary: Get all cities
      description: Returns array of all cities with ~80 fields each.
      operationId: getCities
      responses:
        '200':
          description: Array of cities
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/City'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /city/{id}:
    get:
      tags: [Cities]
      summary: Get city by ID
      description: Returns a single city by its unique ID.
      operationId: getCityById
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: City ID
      responses:
        '200':
          description: City data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/City'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /characters:
    get:
      tags: [Characters]
      summary: Get all characters
      description: Returns array of all characters with ~85 fields each.
      operationId: getCharacters
      responses:
        '200':
          description: Array of characters
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Character'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /character/{id}:
    get:
      tags: [Characters]
      summary: Get character by ID
      description: Returns a single character by their unique ID.
      operationId: getCharacterById
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Character ID
      responses:
        '200':
          description: Character data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Character'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /character-events:
    get:
      tags: [Events]
      summary: Get character events
      description: Returns character events detected from the last turn (births, deaths, marriages, leadership changes).
      operationId: getCharacterEvents
      responses:
        '200':
          description: Array of character events
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CharacterEvent'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /unit-events:
    get:
      tags: [Events]
      summary: Get unit events
      description: Returns unit events detected from the last turn (created, killed).
      operationId: getUnitEvents
      responses:
        '200':
          description: Array of unit events
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UnitEvent'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /city-events:
    get:
      tags: [Events]
      summary: Get city events
      description: Returns city events detected from the last turn (founded, captured).
      operationId: getCityEvents
      responses:
        '200':
          description: Array of city events
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CityEvent'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /tribes:
    get:
      tags: [Tribes]
      summary: Get all tribes
      description: Returns array of all tribes with status and alliance data.
      operationId: getTribes
      responses:
        '200':
          description: Array of tribes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Tribe'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /tribe/{tribeType}:
    get:
      tags: [Tribes]
      summary: Get tribe by type
      description: Returns a single tribe by its type string (case-insensitive).
      operationId: getTribeByType
      parameters:
        - name: tribeType
          in: path
          required: true
          schema:
            type: string
          description: Tribe type (e.g., TRIBE_GAULS)
          example: TRIBE_GAULS
      responses:
        '200':
          description: Tribe data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tribe'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /team-diplomacy:
    get:
      tags: [Diplomacy]
      summary: Get team diplomacy
      description: Returns all directed diplomatic relationships between teams.
      operationId: getTeamDiplomacy
      responses:
        '200':
          description: Array of team diplomacy entries
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TeamDiplomacy'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /team-alliances:
    get:
      tags: [Diplomacy]
      summary: Get team alliances
      description: Returns all team alliance pairs.
      operationId: getTeamAlliances
      responses:
        '200':
          description: Array of team alliances
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TeamAlliance'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /tribe-diplomacy:
    get:
      tags: [Diplomacy]
      summary: Get tribe diplomacy
      description: Returns all directed diplomatic relationships from tribes to teams.
      operationId: getTribeDiplomacy
      responses:
        '200':
          description: Array of tribe diplomacy entries
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TribeDiplomacy'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /tribe-alliances:
    get:
      tags: [Diplomacy]
      summary: Get tribe alliances
      description: Returns all tribe-to-player alliances.
      operationId: getTribeAlliances
      responses:
        '200':
          description: Array of tribe alliances
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TribeAlliance'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /units:
    get:
      tags: [Units]
      summary: Get all units
      description: Returns array of all living units with position, health, and status.
      operationId: getUnits
      responses:
        '200':
          description: Array of units
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Unit'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /unit/{id}:
    get:
      tags: [Units]
      summary: Get unit by ID
      description: Returns a single unit by its unique ID.
      operationId: getUnitById
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Unit ID
      responses:
        '200':
          description: Unit data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Unit'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /player/{index}/units:
    get:
      tags: [Players, Units]
      summary: Get player units
      description: Returns all units owned by a specific player.
      operationId: getPlayerUnits
      parameters:
        - name: index
          in: path
          required: true
          schema:
            type: integer
            minimum: 0
          description: Player index (0-based)
      responses:
        '200':
          description: Array of units
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Unit'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /player/{index}/techs:
    get:
      tags: [Players]
      summary: Get player technologies
      description: Returns technology research state for a player.
      operationId: getPlayerTechs
      parameters:
        - name: index
          in: path
          required: true
          schema:
            type: integer
            minimum: 0
          description: Player index (0-based)
      responses:
        '200':
          description: Technology state
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerTechs'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /player/{index}/families:
    get:
      tags: [Players]
      summary: Get player families
      description: Returns family relationship data for a player.
      operationId: getPlayerFamilies
      parameters:
        - name: index
          in: path
          required: true
          schema:
            type: integer
            minimum: 0
          description: Player index (0-based)
      responses:
        '200':
          description: Family data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerFamilies'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /player/{index}/religion:
    get:
      tags: [Players]
      summary: Get player religion
      description: Returns religion state for a player.
      operationId: getPlayerReligion
      parameters:
        - name: index
          in: path
          required: true
          schema:
            type: integer
            minimum: 0
          description: Player index (0-based)
      responses:
        '200':
          description: Religion state
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerReligion'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /player/{index}/goals:
    get:
      tags: [Players]
      summary: Get player goals
      description: Returns goals and ambitions for a player.
      operationId: getPlayerGoals
      parameters:
        - name: index
          in: path
          required: true
          schema:
            type: integer
            minimum: 0
          description: Player index (0-based)
      responses:
        '200':
          description: Goals data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerGoals'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /player/{index}/decisions:
    get:
      tags: [Players]
      summary: Get player decisions
      description: Returns pending decisions for a player.
      operationId: getPlayerDecisions
      parameters:
        - name: index
          in: path
          required: true
          schema:
            type: integer
            minimum: 0
          description: Player index (0-based)
      responses:
        '200':
          description: Decisions data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerDecisions'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /player/{index}/laws:
    get:
      tags: [Players]
      summary: Get player laws
      description: Returns active laws for a player.
      operationId: getPlayerLaws
      parameters:
        - name: index
          in: path
          required: true
          schema:
            type: integer
            minimum: 0
          description: Player index (0-based)
      responses:
        '200':
          description: Laws data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerLaws'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /player/{index}/missions:
    get:
      tags: [Players]
      summary: Get player missions
      description: Returns active missions for a player.
      operationId: getPlayerMissions
      parameters:
        - name: index
          in: path
          required: true
          schema:
            type: integer
            minimum: 0
          description: Player index (0-based)
      responses:
        '200':
          description: Missions data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerMissions'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /player/{index}/resources:
    get:
      tags: [Players]
      summary: Get player resources
      description: Returns resource and luxury counts for a player.
      operationId: getPlayerResources
      parameters:
        - name: index
          in: path
          required: true
          schema:
            type: integer
            minimum: 0
          description: Player index (0-based)
      responses:
        '200':
          description: Resources data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerResources'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /religions:
    get:
      tags: [Religion]
      summary: Get all religions
      description: Returns global religion state including founded religions and holy cities.
      operationId: getReligions
      responses:
        '200':
          description: Array of religions
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Religion'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /map:
    get:
      tags: [Tiles]
      summary: Get map metadata
      description: Returns map metadata including tile count.
      operationId: getMap
      responses:
        '200':
          description: Map metadata
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MapMetadata'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /tiles:
    get:
      tags: [Tiles]
      summary: Get tiles (paginated)
      description: Returns paginated list of map tiles. Use offset and limit for pagination.
      operationId: getTiles
      parameters:
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
            minimum: 0
          description: Starting index for pagination
        - name: limit
          in: query
          schema:
            type: integer
            default: 100
            minimum: 1
            maximum: 1000
          description: Maximum tiles to return (max 1000)
      responses:
        '200':
          description: Paginated tiles
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TilesPaginated'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /tile/{id}:
    get:
      tags: [Tiles]
      summary: Get tile by ID
      description: Returns a single tile by its unique ID.
      operationId: getTileById
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Tile ID
      responses:
        '200':
          description: Tile data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tile'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /tile/{x}/{y}:
    get:
      tags: [Tiles]
      summary: Get tile by coordinates
      description: Returns a single tile by its x,y coordinates.
      operationId: getTileByCoords
      parameters:
        - name: x
          in: path
          required: true
          schema:
            type: integer
          description: X coordinate
        - name: y
          in: path
          required: true
          schema:
            type: integer
          description: Y coordinate
      responses:
        '200':
          description: Tile data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tile'
        '404':
          $ref: '#/components/responses/NotFound'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

  /config:
    get:
      tags: [Config]
      summary: Get game configuration
      description: Returns game configuration including player count, turn, and year.
      operationId: getConfig
      responses:
        '200':
          description: Game configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GameConfig'
        '503':
          $ref: '#/components/responses/GameNotAvailable'

components:
  schemas:
    GameState:
      type: object
      description: Complete game state snapshot
      properties:
        turn:
          type: integer
          description: Current turn number
        year:
          type: integer
          description: Current year
        currentPlayer:
          type: integer
          description: Player index whose turn it is
        players:
          type: array
          items:
            $ref: '#/components/schemas/Player'
        characters:
          type: array
          items:
            $ref: '#/components/schemas/Character'
        cities:
          type: array
          items:
            $ref: '#/components/schemas/City'
        teamDiplomacy:
          type: array
          items:
            $ref: '#/components/schemas/TeamDiplomacy'
        teamAlliances:
          type: array
          items:
            $ref: '#/components/schemas/TeamAlliance'
        tribes:
          type: array
          items:
            $ref: '#/components/schemas/Tribe'
        tribeDiplomacy:
          type: array
          items:
            $ref: '#/components/schemas/TribeDiplomacy'
        tribeAlliances:
          type: array
          items:
            $ref: '#/components/schemas/TribeAlliance'

    Player:
      type: object
      description: A player (nation) in the game
      properties:
        index:
          type: integer
          description: Player index (0-based)
        team:
          type: integer
          description: Team number
        nation:
          type: string
          description: Nation type (e.g., NATION_ROME)
        leaderId:
          type: integer
          nullable: true
          description: Current leader character ID
        cities:
          type: integer
          description: Number of cities
        units:
          type: integer
          description: Number of units
        legitimacy:
          type: integer
          description: Current legitimacy
        stockpiles:
          type: object
          additionalProperties:
            type: integer
          description: Resource stockpiles by yield type
        rates:
          type: object
          additionalProperties:
            type: integer
          description: Per-turn rates by yield type

    City:
      type: object
      description: A city with ~80 fields
      properties:
        id:
          type: integer
        name:
          type: string
        ownerId:
          type: integer
        tileId:
          type: integer
        x:
          type: integer
        y:
          type: integer
        nation:
          type: string
          nullable: true
        team:
          type: integer
        isCapital:
          type: boolean
        isTribe:
          type: boolean
        isConnected:
          type: boolean
        foundedTurn:
          type: integer
        citizens:
          type: integer
        hp:
          type: integer
        hpMax:
          type: integer
        hasBuild:
          type: boolean
        currentBuild:
          $ref: '#/components/schemas/BuildQueueItem'
        yields:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/YieldDetails'
        improvements:
          type: object
          additionalProperties:
            type: integer

    Character:
      type: object
      description: A character with ~85 fields
      properties:
        id:
          type: integer
        name:
          type: string
        suffix:
          type: string
        gender:
          type: string
          enum: [Male, Female]
        age:
          type: integer
        playerId:
          type: integer
          nullable: true
        nation:
          type: string
          nullable: true
        isAlive:
          type: boolean
        isDead:
          type: boolean
        isLeader:
          type: boolean
        isHeir:
          type: boolean
        traits:
          type: array
          items:
            type: string
        ratings:
          type: object
          additionalProperties:
            type: integer
        spouseIds:
          type: array
          items:
            type: integer
        childrenIds:
          type: array
          items:
            type: integer

    Tribe:
      type: object
      description: A tribe (barbarian faction)
      properties:
        tribeType:
          type: string
          description: Tribe type (e.g., TRIBE_GAULS)
        isAlive:
          type: boolean
        isDead:
          type: boolean
        hasDiplomacy:
          type: boolean
        leaderId:
          type: integer
          nullable: true
        hasLeader:
          type: boolean
        numUnits:
          type: integer
        numCities:
          type: integer
        strength:
          type: integer
        cityIds:
          type: array
          items:
            type: integer
        hasPlayerAlly:
          type: boolean
        allyPlayerId:
          type: integer
          nullable: true

    BuildQueueItem:
      type: object
      nullable: true
      properties:
        buildType:
          type: string
          enum: [UNIT, PROJECT, SPECIALIST]
        itemType:
          type: string
        progress:
          type: integer
        threshold:
          type: integer
        turnsLeft:
          type: integer
        hurried:
          type: boolean

    YieldDetails:
      type: object
      properties:
        perTurn:
          type: integer
        progress:
          type: integer
        threshold:
          type: integer
        overflow:
          type: integer

    Location:
      type: object
      properties:
        tileId:
          type: integer
        x:
          type: integer
        y:
          type: integer

    CharacterEvent:
      type: object
      properties:
        eventType:
          type: string
          enum: [characterBorn, characterDied, leaderChanged, heirChanged, characterMarried]
        characterId:
          type: integer
        parentIds:
          type: array
          items:
            type: integer
        deathReason:
          type: string
          nullable: true
        playerId:
          type: integer
        newLeaderId:
          type: integer
        oldLeaderId:
          type: integer
          nullable: true

    UnitEvent:
      type: object
      properties:
        eventType:
          type: string
          enum: [unitCreated, unitKilled]
        unitId:
          type: integer
        unitType:
          type: string
        playerId:
          type: integer
        lastOwnerId:
          type: integer
        location:
          $ref: '#/components/schemas/Location'
        lastLocation:
          $ref: '#/components/schemas/Location'

    CityEvent:
      type: object
      properties:
        eventType:
          type: string
          enum: [cityFounded, cityCapture]
        cityId:
          type: integer
        cityName:
          type: string
        playerId:
          type: integer
        oldOwnerId:
          type: integer
        newOwnerId:
          type: integer
        wasTribe:
          type: boolean
        location:
          $ref: '#/components/schemas/Location'

    TeamDiplomacy:
      type: object
      properties:
        fromTeam:
          type: integer
        toTeam:
          type: integer
        diplomacy:
          type: string
          nullable: true
        isHostile:
          type: boolean
        isPeace:
          type: boolean
        hasContact:
          type: boolean
        warScore:
          type: integer
        warState:
          type: string
          nullable: true
        conflictTurn:
          type: integer
        conflictNumTurns:
          type: integer
        diplomacyTurn:
          type: integer
        diplomacyNumTurns:
          type: integer

    TeamAlliance:
      type: object
      properties:
        team:
          type: integer
        allyTeam:
          type: integer

    TribeDiplomacy:
      type: object
      properties:
        tribe:
          type: string
        toTeam:
          type: integer
        diplomacy:
          type: string
          nullable: true
        isHostile:
          type: boolean
        isPeace:
          type: boolean
        hasContact:
          type: boolean
        warScore:
          type: integer
        warState:
          type: string
          nullable: true

    TribeAlliance:
      type: object
      properties:
        tribe:
          type: string
        allyPlayerId:
          type: integer
        allyTeam:
          type: integer

    Unit:
      type: object
      description: A unit with position, health, and status
      properties:
        id:
          type: integer
        unitType:
          type: string
          description: Unit type (e.g., UNIT_WARRIOR, UNIT_WORKER)
        ownerId:
          type: integer
          nullable: true
        tileId:
          type: integer
        x:
          type: integer
        y:
          type: integer
        hp:
          type: integer
        hpMax:
          type: integer
        damage:
          type: integer
        isAlive:
          type: boolean
        xp:
          type: integer
        level:
          type: integer
        turnSteps:
          type: integer
        cooldownTurns:
          type: integer
        fortifyTurns:
          type: integer
        createTurn:
          type: integer
        generalId:
          type: integer
          nullable: true
        hasGeneral:
          type: boolean
        isSleep:
          type: boolean
        isSentry:
          type: boolean
        isPass:
          type: boolean
        family:
          type: string
          nullable: true
        hasFamily:
          type: boolean
        religion:
          type: string
          nullable: true
        hasReligion:
          type: boolean
        promotions:
          type: array
          items:
            type: string

    PlayerTechs:
      type: object
      description: Player technology research state
      properties:
        researching:
          type: string
          nullable: true
          description: Currently researching tech type
        progress:
          type: object
          additionalProperties:
            type: integer
          description: Progress per tech type
        researched:
          type: array
          items:
            type: string
          description: Completed tech types
        available:
          type: array
          items:
            type: string
          description: Available tech types

    PlayerFamilies:
      type: object
      description: Player family relationships
      properties:
        families:
          type: array
          items:
            type: object
            properties:
              family:
                type: string
              opinionRate:
                type: integer

    PlayerReligion:
      type: object
      description: Player religion state
      properties:
        stateReligion:
          type: string
          nullable: true
        religionCount:
          type: object
          additionalProperties:
            type: integer

    PlayerGoals:
      type: object
      description: Player goals and ambitions
      properties:
        goals:
          type: array
          items:
            type: object
        note:
          type: string
          description: API limitation note

    PlayerDecisions:
      type: object
      description: Player pending decisions
      properties:
        decisions:
          type: array
          items:
            type: object
        note:
          type: string
          description: API limitation note

    PlayerLaws:
      type: object
      description: Player active laws
      properties:
        laws:
          type: object
          additionalProperties:
            type: string
        note:
          type: string
          description: API limitation note

    PlayerMissions:
      type: object
      description: Player active missions
      properties:
        missions:
          type: array
          items:
            type: object
        note:
          type: string
          description: API limitation note

    PlayerResources:
      type: object
      description: Player resource counts
      properties:
        resources:
          type: object
          additionalProperties:
            type: integer
        note:
          type: string
          description: API limitation note

    Religion:
      type: object
      description: Global religion state
      properties:
        religionType:
          type: string
        isFounded:
          type: boolean
        headCharacterId:
          type: integer
          nullable: true
        holyCityId:
          type: integer
          nullable: true

    MapMetadata:
      type: object
      description: Map metadata
      properties:
        numTiles:
          type: integer

    TilesPaginated:
      type: object
      description: Paginated tiles response
      properties:
        tiles:
          type: array
          items:
            $ref: '#/components/schemas/Tile'
        pagination:
          type: object
          properties:
            offset:
              type: integer
            limit:
              type: integer
            total:
              type: integer
            hasMore:
              type: boolean

    Tile:
      type: object
      description: A map tile
      properties:
        id:
          type: integer
        x:
          type: integer
        y:
          type: integer
        terrain:
          type: string
          description: Terrain type (e.g., TERRAIN_TEMPERATE)
        height:
          type: string
          description: Height type (e.g., HEIGHT_MOUNTAIN)
        vegetation:
          type: string
          nullable: true
        resource:
          type: string
          nullable: true
        improvement:
          type: string
          nullable: true
        isPillaged:
          type: boolean
        ownerId:
          type: integer
          nullable: true
        cityId:
          type: integer
          nullable: true
        cityTerritoryId:
          type: integer
          nullable: true

    GameConfig:
      type: object
      description: Game configuration
      properties:
        numTiles:
          type: integer
        numPlayers:
          type: integer
        numTeams:
          type: integer
        turn:
          type: integer
        year:
          type: integer

    Error:
      type: object
      properties:
        error:
          type: string
          description: Error message
        code:
          type: integer
          description: HTTP status code

  responses:
    BadRequest:
      description: Invalid request parameters
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Invalid player index. Use /player/{index}"
            code: 400

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Player not found: 99"
            code: 404

    GameNotAvailable:
      description: Game not loaded or unavailable
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Game not available"
            code: 503
